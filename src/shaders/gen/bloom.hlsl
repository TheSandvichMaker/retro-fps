// Generated by metagen.lua

#include "bindless.hlsli"

#include "common.hlsli"

struct bloom_draw_parameters_t
{
	df::Resource< Texture2D< float3 > > tex_color;
	float2 inv_tex_size;
};

ConstantBuffer< bloom_draw_parameters_t > draw : register(b0);



float4 bloom_blur_ps(FullscreenTriangleOutVS IN) : SV_Target
{
	Texture2D<float3> tex_color    = draw.tex_color.Get();
	float2            inv_tex_size = draw.inv_tex_size;

	float2 uv = IN.uv;

	float3 sum = 0.0;
	sum += tex_color.SampleLevel(df::s_linear_border, uv + float2(-0.5, -0.5)*inv_tex_size, 0);
	sum += tex_color.SampleLevel(df::s_linear_border, uv + float2(+0.5, -0.5)*inv_tex_size, 0);
	sum += tex_color.SampleLevel(df::s_linear_border, uv + float2(+0.5, +0.5)*inv_tex_size, 0);
	sum += tex_color.SampleLevel(df::s_linear_border, uv + float2(-0.5, +0.5)*inv_tex_size, 0);
	sum *= 0.25;

	return float4(sum, 1);
}